/**
* Facilitas Player
* @version  1.1
* @url http://facilitasplayer.com 
* @author Bruno C. Ramos <bruno@weeag>
* @description Video player focused in providing a better accessibility
* @license BSD-3
*
* Copyright (c) 2014, Bruno C. Ramos, Johana María Rosas Villena, Renata Pontin M. Fortes, Rudinei Goularte
* All rights reserved.
* 
* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
* 
* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
* 
* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.
* 
* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
;(function(b){if(typeof Object.create!=="function"){Object.create=function(d){function c(){}c.prototype=d;return new c()}}b.plugin=function(d,c){b.fn[d]=function(e){return this.each(function(){if(!b.data(this,d)){b.data(this,d,Object.create(c).init(e,this))}})}};var a={init:function(c,d){this.options=b.extend({},this.options,c);this.elem=d;this.$elem=b(d);this._build();return this},options:{theme:"facilitas_modern",videoSpeed:1,fonts:new Array("Trebuchet MS","Arial","Times New Roman","Verdana","Helvetica","Courier New"),initVolume:0.5,initAdVolume:0.8,baseLangFolder:"js/",language:"en",availableLanguages:["pt","en","es"],enableKeyboard:true,fullscreenToolbarSpeed:2000,subtitleSrc:null,audiodescription:null,transcripts:null,version:"1.0",aboutUrl:"www.facilitasplayer.com",init:false,seekSliding:false,bufferSliding:false,currentBuffer:0,volumeSliding:false,isFullscreen:false,isLightOn:false,oldVol:null,oldAdVol:null,hasTags:false,debug:true,subtitleCount:0,subtitleTotal:0,currentSubtitleLine:-1,newSubtitleLine:null,fullscreenToolbarHidden:false,fullscreenToolbarHover:false,mouseX:0,mouseY:0,fullscreenTimer:null,browserPrefix:null,browserPrefixes:"webkit moz o ms".split(" "),supportsFullScreen:false,supportsSpeedChange:false,loading:true,sidebar_captionsearch:false,sidebar_settings:false,sidebar_transcript:false,helpIsOpen:false,caption_list_height:0,lang:{},body:null,video_parent:null,video_container:null,video_controls:null,facilitas_play:null,facilitas_stop:null,facilitas_speedup:null,facilitas_speeddown:null,facilitas_speedwarning:null,facilitas_audiodesc_btn:null,facilitas_search_btn:null,facilitas_settings_btn:null,facilitas_help:null,facilitas_help_btn:null,facilitas_video_seek:null,facilitas_video_buffer:null,facilitas_video_timer:null,facilitas_volume:null,facilitas_volume_btn:null,facilitas_volume_status:null,facilitas_cc:null,facilitas_cc_btn:null,facilitas_volume_slider:null,facilitas_viewport:null,facilitas_tags:null,facilitas_tags_goto:null,facilitas_progress:null,facilitas_toolbar:null,facilitas_subtitle:null,facilitas_light_bg:null,facilitas_light_toggle:null,facilitas_loading:null,facilitas_search_form:null,facilitas_search_result:null,facilitas_search_input:null,facilitas_search_inputbtn:null,facilitas_language:null,facilitas_toolbarposition:null,facilitas_fontbackground:null,facilitas_fontfamily:null,facilitas_fontcolor:null,facilitas_fontsize:null,videoObject:null,facilitas_audiodesc:null,facilitas_advolume:null,facilitas_advolume_btn:null,facilitas_advolume_status:null,facilitas_advolume_slider:null,facilitas_transcript_btn:null,facilitas_transcript:null,subtitle:null},_build:function(){var f=this,d=this.$elem,g=this.options;g.parent=d.parent();g.body=b("body");var c=b("<div></div>").addClass("facilitas_player").addClass(g.theme);if(typeof(d.attr("width"))!=="undefined"){c.width(d.attr("width"))}if(typeof(d.attr("width"))!=="undefined"){c.height(d.attr("height"))}g.facilitas_light_bg=b("<div></div>").addClass("facilitas_light_bg").addClass(g.theme);b.getJSON(g.baseLangFolder+"FacilitasLang/"+g.language+".js",function(k){g.lang[g.language]=k;var l,h,e;if(typeof(d.attr("data-tagList"))!=="undefined"){e="#"+d.attr("data-tagList");h=b(e);if(h.length>0){l='<div class="facilitas_tags"><p class="facilitas_tags_goto">'+g.lang[g.language].tags.goTo+":</p></div>";g.hasTags=true}}else{l=""}if(typeof(d.attr("data-audiodescription"))!=="undefined"){g.audiodescription=d.attr("data-audiodescription")}if(typeof(d.attr("data-transcripts"))!=="undefined"){g.transcripts=d.attr("data-transcripts")}b(".facilitas_tags",d).remove();var j=b('<div class="facilitas_progress">    <div class="facilitas_buffbar"></div>    <div class="facilitas_progbar">        <ul class="facilitas_stickers"></ul>    </div></div><div class="facilitas_toolbar">  <ul class="facilitas_controls" title="Toolbar">      <li><button class="facilitas_btn_play" title="'+g.lang[g.language].toolbar.play+'"><span class="fac-i-play"></span></button></li>      <li><button class="facilitas_btn_stop" title="'+g.lang[g.language].toolbar.stop+'"><span class="fac-i-stop"></span></button></li>      <li><button class="facilitas_btn_speeddown" title="'+g.lang[g.language].toolbar.rewind+'"><span class="fac-i-rewind"></span></button></li>      <li><button class="facilitas_btn_speedup" title="'+g.lang[g.language].toolbar.forward+'"><span class="fac-i-forward"></span></button></li>      <li title="'+g.lang[g.language].toolbar.time+'" class="facilitas_time"><div class="facilitas_timeupdate">00:00 / 00:00</div><div class="facilitas_speedwarning">2x</div></li>  </ul>  <ul class="facilitas_controls fr" title="Toolbar">      <li><button class="facilitas_btn_search" title="'+g.lang[g.language].toolbar.search+'"><span class="fac-i-search"></span></button></li>      <li><button class="facilitas_btn_cc" title="'+g.lang[g.language].toolbar.caption+'"><span class="fac-i-closedcaption"></span></button></li>      <li><button class="facilitas_transcript_btn" title="'+g.lang[g.language].toolbar.transcript+'"><span class="fac-i-transcript"></span></button></li>      <li><button class="facilitas_btn_settings" title="'+g.lang[g.language].toolbar.settings+'"><span class="fac-i-settings"></span></button></li>      <li>          <a href="javascript:void();" class="facilitas_btn_volume" title="'+g.lang[g.language].toolbar.volume+'">              <span class="vol_status fac-i-sound-half"></span>              <div class="facilitas_btn_container"></div>              <div class="facilitas_vol_container">                  <div class="facilitas_vol_wrapper">                      <div class="facilitas_control_volume_slider"></div>                  </div>              </div>          </a>      </li>      <li><button class="facilitas_btn_help" title="'+g.lang[g.language].toolbar.help+'"><span class="fac-i-help"></span></button></li>      <li><button class="facilitas_btn_viewport" title="'+g.lang[g.language].toolbar.viewport+'"><span class="fac-i-fullscreen-open"></span></button></li>  </ul></div><div class="facilitas_subtitle" aria-live="assertive"></div><div class="facilitas_closedcaption"></div>'+l+'<div class="facilitas_help">  <span class="facilitas_help_title" title="'+g.lang[g.language].help.title+'">'+g.lang[g.language].help.title+'</span>  <div class="facilitas_help_content">      <ul>          <li title="'+g.lang[g.language].help.keyboard+'"><strong>'+g.lang[g.language].help.keyboard+'</strong></li>          <li title="P - '+g.lang[g.language].help.play+'"><strong>P</strong>'+g.lang[g.language].help.play+'</li>          <li title="Q - '+g.lang[g.language].help.stop+'"><strong>Q</strong>'+g.lang[g.language].help.stop+'</li>          <li title="S - '+g.lang[g.language].help.search+'"><strong>S</strong>'+g.lang[g.language].help.search+'</li>          <li title="E - '+g.lang[g.language].help.speeddown+'"><strong>E</strong>'+g.lang[g.language].help.speeddown+'</li>          <li title="R - '+g.lang[g.language].help.speedup+'"><strong>R</strong>'+g.lang[g.language].help.speedup+'</li>          <li title="Y - '+g.lang[g.language].help.rewind+'"><strong>Y</strong>'+g.lang[g.language].help.rewind+'</li>          <li title="U - '+g.lang[g.language].help.forward+'"><strong>U</strong>'+g.lang[g.language].help.forward+'</li>          <li title="T - '+g.lang[g.language].help.transcript+'"><strong>T</strong>'+g.lang[g.language].help.transcript+'</li>          <li title="C - '+g.lang[g.language].help.caption+'"><strong>C</strong>'+g.lang[g.language].help.caption+'</li>          <li title="M - '+g.lang[g.language].help.volume+'"><strong>M</strong>'+g.lang[g.language].help.volume+'</li>          <li title="V - '+g.lang[g.language].help.decreaseVol+'"><strong>V</strong>'+g.lang[g.language].help.decreaseVol+'</li>          <li title="B - '+g.lang[g.language].help.increaseVol+'"><strong>B</strong>'+g.lang[g.language].help.increaseVol+'</li>          <li title="A - '+g.lang[g.language].help.adVolume+'"><strong>A</strong>'+g.lang[g.language].help.adVolume+'</li>          <li title="Z - '+g.lang[g.language].help.adDecreaseVol+'"><strong>Z</strong>'+g.lang[g.language].help.adDecreaseVol+'</li>          <li title="X - '+g.lang[g.language].help.adIncreaseVol+'"><strong>X</strong>'+g.lang[g.language].help.adIncreaseVol+'</li>          <li title="F - '+g.lang[g.language].help.viewport+'"><strong>F</strong>'+g.lang[g.language].help.viewport+'</li>          <li title="H - '+g.lang[g.language].help.help+'"><strong>H</strong>'+g.lang[g.language].help.help+'</li>      </ul>  </div>  <div class="facilitas_help_content facilitas_help_about">      <ul>          <li>Facilitas Player v'+g.version+'</li>          <li><a href="'+g.aboutUrl+'" target="_blank" title="Facilitas Player">'+g.aboutUrl+'</a></li>      </ul>  </div></div><div class="facilitas_sidebar facilitas_caption_search">  <header>      <div class="facilitas_sidebar_title" title="'+g.lang[g.language].sidebarSearch.title+'"><span class="title">'+g.lang[g.language].sidebarSearch.title+'</span> <button data-type="search" class="facilitas_sidebar_close" title="'+g.lang[g.language].buttons.close+'"><span class="fac-i-close"></span></button></div>      <div class="facilitas_sidebar_search"><form class="facilitas_fsearch"><input type="text" class="facilitas_search_input" placeholder="'+g.lang[g.language].sidebarSearch.input+'" title="'+g.lang[g.language].sidebarSearch.input+'" /> <button class="facilitas_btn_inputsearch" title="'+g.lang[g.language].sidebarSearch.button+'"><span class="fac-i-search"></span></button></form></div>  </header>  <ol class="facilitas_search_result"></ol></div><div class="facilitas_sidebar facilitas_settings">  <header>      <div class="facilitas_sidebar_title" title="'+g.lang[g.language].sidebarSettings.title+'"><span class="title">'+g.lang[g.language].sidebarSettings.title+'</span> <button data-type="settings" class="facilitas_sidebar_close" title="'+g.lang[g.language].buttons.close+'"><span class="fac-i-close"></span></button></div>  </header>  <ul class="facilitas_sidebar_cont">      <li>          <label for="facilitas_language" title="'+g.lang[g.language].sidebarSettings.language.title+'">'+g.lang[g.language].sidebarSettings.language.title+'</label>          <select name="facilitas_language" class="facilitas_language" title="'+g.lang[g.language].sidebarSettings.language.title+'">              <option value="'+g.lang[g.language].about.file+'" title="'+g.lang[g.language].about.title+'" selected="selected">'+g.lang[g.language].about.title+'</option>          </select>      </li>      <li>          <label for="facilitas_toolbarPosition" title="'+g.lang[g.language].sidebarSettings.toolbar.position.title+'">'+g.lang[g.language].sidebarSettings.toolbar.position.title+'</label>          <select name="facilitas_toolbarPosition" class="facilitas_toolbarPosition" title="'+g.lang[g.language].sidebarSettings.toolbar.position.title+'">              <option value="bottom" title="'+g.lang[g.language].sidebarSettings.toolbar.position.posBottom+'" selected="selected">'+g.lang[g.language].sidebarSettings.toolbar.position.posBottom+'</option>          </select>      </li>      <li>          <label for="captionStyleTitle" title="'+g.lang[g.language].sidebarSettings.caption.captionStyle+'">'+g.lang[g.language].sidebarSettings.caption.captionStyle+'</label>          <label class="facilitas_label_subtitle" for="facilitas_fontbackground" title="'+g.lang[g.language].sidebarSettings.caption.backgroundColor.title+'">'+g.lang[g.language].sidebarSettings.caption.backgroundColor.title+'</label>          <select name="facilitas_fontbackground" class="facilitas_fontbackground" title="'+g.lang[g.language].sidebarSettings.caption.backgroundColor.title+'">              <option value="none" selected="selected" title="'+g.lang[g.language].sidebarSettings.caption.backgroundColor.opNoBackground+'">'+g.lang[g.language].sidebarSettings.caption.backgroundColor.opNoBackground+'</option>              <option value="black" title="'+g.lang[g.language].sidebarSettings.caption.backgroundColor.opBlack+'">'+g.lang[g.language].sidebarSettings.caption.backgroundColor.opBlack+'</option>              <option value="halfblack" title="'+g.lang[g.language].sidebarSettings.caption.backgroundColor.opTransBlack+'">'+g.lang[g.language].sidebarSettings.caption.backgroundColor.opTransBlack+'</option>              <option value="white" title="'+g.lang[g.language].sidebarSettings.caption.backgroundColor.opWhite+'">'+g.lang[g.language].sidebarSettings.caption.backgroundColor.opWhite+'</option>              <option value="halfwhite" title="'+g.lang[g.language].sidebarSettings.caption.backgroundColor.opTransWhite+'">'+g.lang[g.language].sidebarSettings.caption.backgroundColor.opTransWhite+'</option>          </select>          <label class="facilitas_label_subtitle" for="facilitas_fontfamily" title="'+g.lang[g.language].sidebarSettings.caption.fontFamily+'">'+g.lang[g.language].sidebarSettings.caption.fontFamily+'</label>          <select name="facilitas_fontfamily" class="facilitas_fontfamily" title="'+g.lang[g.language].sidebarSettings.caption.fontFamily+'">          </select>          <div class="facilitas_settings_split">              <label class="facilitas_label_subtitle" for="facilitas_fontcolor" maxlength="7" title="'+g.lang[g.language].sidebarSettings.caption.fontColor+'">'+g.lang[g.language].sidebarSettings.caption.fontColor+'</label>              <input name="facilitas_fontcolor" class="facilitas_fontcolor" title="'+g.lang[g.language].sidebarSettings.caption.fontColor+'" value="E1EB1A" placeholder="E1EB1A" />          </div>          <div class="facilitas_settings_splitright">              <label class="facilitas_label_subtitle" for="facilitas_fontsize" title="'+g.lang[g.language].sidebarSettings.caption.fontSize+'">'+g.lang[g.language].sidebarSettings.caption.fontSize+'</label>              <select name="facilitas_fontsize" class="facilitas_fontsize" title="'+g.lang[g.language].sidebarSettings.caption.fontSize+'">                  <option value="8">8</option>                  <option value="10">10</option>                  <option value="12">12</option>                  <option value="14" selected="selected">14</option>                  <option value="16">16</option>                  <option value="18">18</option>                  <option value="20">20</option>                  <option value="24">24</option>                  <option value="30">30</option>                  <option value="36">36</option>                  <option value="40">40</option>              </select>          </div>      </li>  </ul></div><div class="facilitas_transcript"><header><span class="title">'+g.lang[g.language].sidebarTranscript.title+'</span> <button data-type="transcript" class="facilitas_sidebar_close" title="'+g.lang[g.language].buttons.close+'"><span class="fac-i-close"></span></button></header><ol></ol></div><div class="facilitas_loading"><div class="facilitas_loading_img"></div></div><button class="facilitas_btn_light" title="'+g.lang[g.language].lights.turnOn+'"><span class="fac-i-light"></span></button>');d.addClass("facilitas_video");d.wrap(c);d.after(j);d.wrap(b("<div/>")).parent().addClass("facilitas_player_video");if(g.hasTags){h.appendTo(b(".facilitas_tags"))}b("body").append(g.facilitas_light_bg);g.videoObject=d[0];f.getInstances();f.bindControlActions();f.bindVideoActions();if(g.enableKeyboard===true){f.bindKeyboardShortcuts()}f.disableBtn(g.facilitas_cc);f.prepareSubtitle();f.prepareAudiodescription();f.prepareTranscripts();f.checkSupport();f.checkAdditionalLanguages();d.removeAttr("controls");f.startTemplate()}).fail(function(){alert("Couldn't load language file!")})},startTemplate:function(){var c=this,g=this.options,l=this.options.facilitas_toolbar.height(),h=g.facilitas_progress.height(),j=c.$elem.prop("width"),d=c.$elem.prop("height"),k=g.facilitas_tags.height(),f=d+l+h;if(k){f+=k}g.video_container.height(f-15);if(!k){g.facilitas_toolbar.css("bottom",0);g.facilitas_subtitle.css("bottom",l+17)}else{g.facilitas_subtitle.css("bottom",l+k+10)}if(k){g.facilitas_progress.css("bottom",k+l-5)}else{g.facilitas_progress.css("bottom",l)}g.facilitas_fontcolor.minicolors({letterCase:"uppercase",swatchPosition:"right",change:function(o,m){c.changeColor(o)}});for(i=0,n=g.fonts.length;i<n;i++){var e="";if(i==0){e=' selected="selected"'}g.facilitas_fontfamily.append('<option value="'+g.fonts[i]+'" title="'+g.fonts[i]+'"'+e+">"+g.fonts[i]+"</option>")}g.facilitas_caption_search.height(f-17);g.facilitas_search_result.height(f-g.facilitas_caption_search.find("header").height()-12);if(g.supportsFullScreen){b(window).on("mousemove",function(m){if(g.isFullscreen){if(g.fullscreenToolbarHidden){g.facilitas_progress.fadeIn(200);g.facilitas_toolbar.fadeIn(200);g.fullscreenToolbarHidden=false}clearInterval(g.fullscreenTimer);g.fullscreenTimer=setInterval(function(){c.hideFullscreenToolbar()},g.fullscreenToolbarSpeed)}});g.facilitas_progress.on("mouseenter",function(){g.fullscreenToolbarHover=true}).on("mouseleave",function(){g.fullscreenToolbarHover=false});g.facilitas_toolbar.on("mouseenter",function(){g.fullscreenToolbarHover=true}).on("mouseleave",function(){g.fullscreenToolbarHover=false})}},getInstances:function(){var e=this.options;e.video_container=this.$elem.parents(".facilitas_player");var d=e.video_container;e.video_controls=b(".facilitas_controls",e.video_container);e.facilitas_play=b(".facilitas_btn_play",e.video_container);e.facilitas_stop=b(".facilitas_btn_stop",e.video_container);e.facilitas_speedup=b(".facilitas_btn_speedup",e.video_container);e.facilitas_speeddown=b(".facilitas_btn_speeddown",e.video_container);e.facilitas_speedwarning=b(".facilitas_speedwarning",e.video_container);e.facilitas_search_btn=b(".facilitas_btn_search",e.video_container);e.facilitas_settings_btn=b(".facilitas_btn_settings",e.video_container);e.facilitas_video_seek=b(".facilitas_progbar",e.video_container);e.facilitas_video_buffer=b(".facilitas_buffbar",e.video_container);e.facilitas_video_timer=b(".facilitas_timeupdate",e.video_container);e.facilitas_volume=b(".facilitas_btn_volume",e.video_container);e.facilitas_volume_btn=b(".facilitas_btn_container",e.video_container);e.facilitas_volume_status=b(".vol_status",e.video_container);e.facilitas_cc=b(".facilitas_btn_cc",e.video_container);e.facilitas_volume_slider=b(".facilitas_control_volume_slider",e.video_container);e.facilitas_volume_cont=b(".facilitas_vol_container",e.video_container);e.facilitas_help=b(".facilitas_help",e.video_container);e.facilitas_help_btn=b(".facilitas_btn_help",e.video_container);e.facilitas_viewport=b(".facilitas_btn_viewport",e.video_container);e.facilitas_tags=b(".facilitas_tags",e.video_container);e.facilitas_tags_goto=b(".facilitas_tags_goto",e.video_container);e.facilitas_stickers=b(".facilitas_stickers",e.video_container);e.facilitas_progress=b(".facilitas_progress",e.video_container);e.facilitas_toolbar=b(".facilitas_toolbar",e.video_container);e.facilitas_subtitle=b(".facilitas_subtitle",e.video_container);e.facilitas_light_toggle=b(".facilitas_btn_light",e.video_container);e.facilitas_loading=b(".facilitas_loading",e.video_container);e.facilitas_caption_search=b(".facilitas_caption_search",e.video_container);e.facilitas_search_form=b(".facilitas_fsearch",e.video_container);e.facilitas_search_result=b(".facilitas_search_result",e.video_container);e.facilitas_search_input=b(".facilitas_search_input",e.video_container);e.facilitas_search_inputbtn=b(".facilitas_btn_inputsearch",e.video_container);e.facilitas_sidebar_close=b(".facilitas_sidebar_close",e.video_container);e.facilitas_settings=b(".facilitas_settings",e.video_container);e.facilitas_toolbarposition=b(".facilitas_toolbarposition",e.video_container);e.facilitas_language=b(".facilitas_language",e.video_container);e.facilitas_fontfamily=b(".facilitas_fontfamily",e.video_container);e.facilitas_fontbackground=b(".facilitas_fontbackground",e.video_container);e.facilitas_fontcolor=b(".facilitas_fontcolor",e.video_container);e.facilitas_fontsize=b(".facilitas_fontsize",e.video_container);e.facilitas_transcript=b(".facilitas_transcript",e.video_container);e.facilitas_transcript_btn=b(".facilitas_transcript_btn",e.video_container)},initInstances:function(f){var e=this;var g=this.options;if(g.init==false){var d=g.videoObject.duration;g.facilitas_video_seek.slider({value:0,step:0.01,orientation:"horizontal",range:"min",max:d,animate:true,slide:function(j,h){e.timeUpdate(h.value);g.seekSliding=true},stop:function(j,h){g.seekSliding=false},change:function(j,h){e.updateBufferRange()}});g.facilitas_video_seek.val(30);g.facilitas_video_buffer.slider({range:true,disabled:true,min:0,max:100,values:[0,100]});g.facilitas_volume_slider.slider({value:g.initVolume,orientation:"vertical",range:"min",max:1,step:0.1,animate:true,slide:function(j,h){e.toggleMute(h.value)}});e.playbackRate=g.videoSpeed;e.$elem.prop("volume",g.initVolume);if(g.hasTags){var c=g.facilitas_video_seek.slider("option","max");b("a",g.facilitas_tags).each(function(){var j=b(this).attr("href").substr(1);j=e.secondsTimeFormat(j);var h=j*100/c,k=b(this).attr("title");g.facilitas_stickers.append('<li style="left:'+h+'%"><a href="#" title="'+k+'"><span class="fac-sr-only">'+k+"</span></a></li>")})}g.init=true}},bindControlActions:function(){var c=this;var d=this.options;d.facilitas_play.on("click",function(f){c.play();f.preventDefault();return false});this.$elem.on("click",function(f){c.play();f.preventDefault();return false});d.facilitas_stop.on("click",function(f){c.stop();f.preventDefault();return false});d.facilitas_speeddown.on("click",function(f){c.rewind();f.preventDefault();return false});d.facilitas_speedup.on("click",function(f){c.forward();f.preventDefault();return false});d.facilitas_viewport.on("click",function(f){c.toggleFullScreen();f.preventDefault();return false});d.facilitas_light_toggle.on("click",function(f){c.toggleLight();f.preventDefault();return false});d.facilitas_search_btn.on("click",function(f){c.toggleCaptionSearchSidebar();f.preventDefault();return false});d.facilitas_settings_btn.on("click",function(f){c.toggleSettingsSidebar();f.preventDefault();return false});d.facilitas_transcript_btn.on("click",function(f){c.toggleTranscriptSidebar();f.preventDefault();return false});d.facilitas_help_btn.on("click",function(f){c.toggleHelp();f.preventDefault();return false});d.facilitas_sidebar_close.on("click",function(g){var f=b(this).attr("data-type");c.closeSidebar(f);g.preventDefault();return false});d.facilitas_volume_btn.on("click",function(f){c.toggleMute(null);f.preventDefault();return false});d.facilitas_volume.on("mouseenter",function(){c.showVolumeBar()}).on("mouseleave",function(){c.hideVolumeBar()});d.facilitas_search_result.on("click","a",function(g){var f=b(this).attr("href").substr(1);c.goTo(f);g.preventDefault();return false});d.facilitas_tags.on("click","a",function(g){var f=b(this).attr("href").substr(1);var f=c.secondsTimeFormat(f);c.timeUpdate(f);g.preventDefault();return false}).on("mouseenter","li",function(e){var f=b(this).index();d.facilitas_stickers.find("li:nth-child("+(f+1)+") a").addClass("facilitas_selected")}).on("mouseleave","li",function(){b(".facilitas_selected",d.facilitas_stickers).removeClass("facilitas_selected")});d.facilitas_stickers.on("mouseenter","li",function(e){var f=b(this).index();d.facilitas_tags.find("li:nth-child("+(f+1)+") a").addClass("facilitas_selected")}).on("mouseleave","li",function(){b(".facilitas_selected",d.facilitas_tags).removeClass("facilitas_selected")}).on("click",function(f){f.preventDefault();return false});d.video_container.on({mouseenter:function(){if(!d.isFullscreen){c.showLightBtn()}},mouseleave:function(){if(!d.isFullscreen){c.hideLightBtn()}}});d.facilitas_search_form.on("submit",function(){c.searchSubtitle();return false});d.facilitas_search_inputbtn.on("click",function(f){c.searchSubtitle();f.preventDefault();return false});b(window).resize(function(){c.updateLightPos(false)});d.facilitas_language.on("change",function(){b("option:selected",b(this)).each(function(){var e=b(this).val();if(e!=d.language){d.language=e;c.renderLanguage()}})});d.facilitas_fontbackground.on("change",function(){b("option:selected",b(this)).each(function(){var g=b(this).val(),f=null,e="nobackground black halfblack white halfwhite";d.facilitas_subtitle.removeClass(e);switch(g){case"none":d.facilitas_subtitle.addClass("nobackground");break;case"black":d.facilitas_subtitle.addClass("black");break;case"halfblack":d.facilitas_subtitle.addClass("halfblack");break;case"white":d.facilitas_subtitle.addClass("white");break;case"halfwhite":d.facilitas_subtitle.addClass("halfwhite");break;default:d.facilitas_subtitle.addClass("nobackground");break}})});d.facilitas_fontfamily.on("change",function(){b("option:selected",b(this)).each(function(){var e=b(this).val();d.facilitas_subtitle.css("font-family",e)})});d.facilitas_fontcolor.on("keyup",function(){var e=b(this).val();c.changeColor(e)});d.facilitas_fontsize.on("change",function(){b("option:selected",b(this)).each(function(){var e=b(this).val();d.facilitas_subtitle.css({"font-size":(e+"pt"),"line-height":(e+"pt")});c.subtitleFontUpdate()})})},bindVideoActions:function(){var c=this;var d=this.options;c.$elem.bind("play",function(){c.hideLoading();d.facilitas_play.removeClass("facilitas_btn_play").addClass("facilitas_btn_pause").html('<span class="fac-i-pause"></span>')}).bind("pause",function(){d.facilitas_play.removeClass("facilitas_btn_pause").addClass("facilitas_btn_play").html('<span class="fac-i-play"></span>')}).bind("playing loadedmetadata updateMediaState canplay",function(){c.initInstances()}).bind("loadstart",function(){c.showLoading()}).bind("canplay canplaythrough loadeddata",function(){c.hideLoading()}).bind("stalled waiting",function(){c.showLoading()}).bind("timeupdate",function(){c.seekUpdate();if(d.subtitle){c.subtitleUpdate()}if(d.closedCaption){c.closedCaptionUpdate()}}).bind("volumechange",function(){c.volumeUpdate()}).bind("progress",function(){c.bufferUpdate()})},bindKeyboardShortcuts:function(){var c=this;var d=this.options;b(document).on("keyup",function(f){if(b("input").is(":focus")||b("textarea").is(":focus")){return false}switch(f.which){case 80:c.play();break;case 84:c.toggleTranscriptSidebar();break;case 67:c.toggleSubtitle();break;case 65:if(d.facilitas_audiodesc){c.toggleAdMute(null)}break;case 77:c.toggleMute(null);break;case 66:if(d.init){c.increaseVolume()}break;case 86:if(d.init){c.decreaseVolume()}break;case 88:if(d.init){c.increaseAdVolume()}break;case 90:if(d.init){c.decreaseAdVolume()}break;case 83:c.toggleCaptionSearchSidebar();break;case 70:c.toggleFullScreen();break;case 72:c.toggleHelp();break;case 69:c.speedDown();break;case 82:c.speedUp();break;case 81:c.stop();break;case 89:c.rewind();break;case 85:c.forward();break;default:break}})},checkSupport:function(){var d=this;var e=this.options;if(typeof document.cancelFullScreen!="undefined"){d.supportsFullScreen=true}else{for(var c=0;c<e.browserPrefixes.length;c++){e.browserPrefix=e.browserPrefixes[c];if(typeof document[e.browserPrefix+"CancelFullScreen"]!="undefined"){e.supportsFullScreen=true;break}}if(e.browserPrefix!="webkit"){d.disableBtn(e.facilitas_speedup);d.disableBtn(e.facilitas_speeddown);e.supportsSpeedChange=false}else{e.supportsSpeedChange=true}}},checkAdditionalLanguages:function(){var f=this.options;for(var c=0,e=f.availableLanguages.length;c<e;c++){var d=f.availableLanguages[c];if(d!=f.language){this.getLanguage(d)}}},getLanguage:function(d){var c=this.options;b.getJSON(c.baseLangFolder+"FacilitasLang/"+d+".js",function(e){c.lang[d]=e;c.facilitas_language.append('<option value="'+e.about.file+'" title="'+e.about.title+'">'+e.about.title+"</option>")})},renderLanguage:function(){var f=this.options;var c=f.video_container;var d=b(".facilitas_caption_search",c);d.find(".facilitas_sidebar_title").attr("title",f.lang[f.language].sidebarSearch.title).find("span.title").html(f.lang[f.language].sidebarSearch.title).siblings("button").attr("title",f.lang[f.language].buttons.close);d.find(".facilitas_search_input").attr("title",f.lang[f.language].sidebarSearch.input).attr("title",f.lang[f.language].sidebarSearch.input);d.find(".facilitas_btn_inputsearch").attr("title",f.lang[f.language].sidebarSearch.button);f.facilitas_transcript.find("span.title").html(f.lang[f.language].sidebarTranscript.title).siblings("button").attr("title",f.lang[f.language].buttons.close);d=b(".facilitas_settings",c);d.find(".facilitas_sidebar_title").attr("title",f.lang[f.language].sidebarSettings.title).find("span.title").html(f.lang[f.language].sidebarSettings.title).siblings("button").attr("title",f.lang[f.language].buttons.close);d.find("label[for=facilitas_language]").attr("title",f.lang[f.language].sidebarSettings.language.title).html(f.lang[f.language].sidebarSettings.language.title).siblings("select").attr("title",f.lang[f.language].sidebarSettings.language.title);d.find("label[for=facilitas_toolbarPosition]").attr("title",f.lang[f.language].sidebarSettings.toolbar.position.title).html(f.lang[f.language].sidebarSettings.toolbar.position.title).siblings("select").attr("title",f.lang[f.language].sidebarSettings.toolbar.position.title).find("option").attr("title",f.lang[f.language].sidebarSettings.toolbar.position.posBottom).html(f.lang[f.language].sidebarSettings.toolbar.position.posBottom);d.find("label[for=captionStyleTitle]").attr("title",f.lang[f.language].sidebarSettings.caption.captionStyle).html(f.lang[f.language].sidebarSettings.caption.captionStyle).siblings("label[for=facilitas_fontbackground]").attr("title",f.lang[f.language].sidebarSettings.caption.backgroundColor.title).html(f.lang[f.language].sidebarSettings.caption.backgroundColor.title).siblings(".facilitas_fontbackground").attr("title",f.lang[f.language].sidebarSettings.caption.backgroundColor.title).html('<option value="none" selected="selected" title="'+f.lang[f.language].sidebarSettings.caption.backgroundColor.opNoBackground+'">'+f.lang[f.language].sidebarSettings.caption.backgroundColor.opNoBackground+'</option><option value="black" title="'+f.lang[f.language].sidebarSettings.caption.backgroundColor.opBlack+'">'+f.lang[f.language].sidebarSettings.caption.backgroundColor.opBlack+'</option><option value="halfblack" title="'+f.lang[f.language].sidebarSettings.caption.backgroundColor.opTransBlack+'">'+f.lang[f.language].sidebarSettings.caption.backgroundColor.opTransBlack+'</option><option value="white" title="'+f.lang[f.language].sidebarSettings.caption.backgroundColor.opWhite+'">'+f.lang[f.language].sidebarSettings.caption.backgroundColor.opWhite+'</option><option value="halfwhite" title="'+f.lang[f.language].sidebarSettings.caption.backgroundColor.opTransWhite+'">'+f.lang[f.language].sidebarSettings.caption.backgroundColor.opTransWhite+"</option>").siblings("label[for=facilitas_fontfamily]").attr("title",f.lang[f.language].sidebarSettings.caption.fontFamily).html(f.lang[f.language].sidebarSettings.caption.fontFamily).siblings(".facilitas_fontfamily").attr("title",f.lang[f.language].sidebarSettings.caption.fontFamily);d.find("label[for=facilitas_fontcolor]").attr("title",f.lang[f.language].sidebarSettings.caption.fontColor).html(f.lang[f.language].sidebarSettings.caption.fontColor);d.find("label[for=facilitas_fontsize]").attr("title",f.lang[f.language].sidebarSettings.caption.fontSize).html(f.lang[f.language].sidebarSettings.caption.fontSize).siblings(".facilitas_fontsize").attr("title",f.lang[f.language].sidebarSettings.caption.fontSize);var d=b(".facilitas_btn_light",c);if(f.isLightOn){d.attr("title",f.lang[f.language].lights.turnOn).removeClass("active")}else{d.attr("title",f.lang[f.language].lights.turnOff).addClass("active")}f.facilitas_play.attr("title",f.lang[f.language].toolbar.play);f.facilitas_stop.attr("title",f.lang[f.language].toolbar.stop);f.facilitas_speeddown.attr("title",f.lang[f.language].toolbar.speeddown);f.facilitas_speedup.attr("title",f.lang[f.language].toolbar.speedup);f.facilitas_video_timer.attr("title",f.lang[f.language].toolbar.time);f.facilitas_search_btn.attr("title",f.lang[f.language].toolbar.search);f.facilitas_cc.attr("title",f.lang[f.language].toolbar.caption);f.facilitas_transcript_btn.attr("title",f.lang[f.language].toolbar.transcript);f.facilitas_settings_btn.attr("title",f.lang[f.language].toolbar.settings);f.facilitas_volume.attr("title",f.lang[f.language].toolbar.volume);f.facilitas_viewport.attr("title",f.lang[f.language].toolbar.viewport);f.facilitas_help.find(".facilitas_help_title").attr("title",f.lang[f.language].help.title).html(f.lang[f.language].help.title).siblings(".facilitas_help_content").first().find("ul").html('<li title="'+f.lang[f.language].help.keyboard+'"><strong>'+f.lang[f.language].help.keyboard+'</strong></li>          <li title="P - '+f.lang[f.language].help.play+'"><strong>P</strong>'+f.lang[f.language].help.play+'</li>          <li title="Q - '+f.lang[f.language].help.stop+'"><strong>Q</strong>'+f.lang[f.language].help.stop+'</li>          <li title="S - '+f.lang[f.language].help.search+'"><strong>S</strong>'+f.lang[f.language].help.search+'</li>          <li title="E - '+f.lang[f.language].help.speeddown+'"><strong>E</strong>'+f.lang[f.language].help.speeddown+'</li>          <li title="R - '+f.lang[f.language].help.speedup+'"><strong>R</strong>'+f.lang[f.language].help.speedup+'</li>          <li title="T - '+f.lang[f.language].help.rewind+'"><strong>T</strong>'+f.lang[f.language].help.rewind+'</li>          <li title="Y - '+f.lang[f.language].help.forward+'"><strong>Y</strong>'+f.lang[f.language].help.forward+'</li>          <li title="T - '+f.lang[f.language].help.transcript+'"><strong>T</strong>'+f.lang[f.language].help.transcript+'</li>          <li title="C - '+f.lang[f.language].help.caption+'"><strong>C</strong>'+f.lang[f.language].help.caption+'</li>          <li title="M - '+f.lang[f.language].help.volume+'"><strong>M</strong>'+f.lang[f.language].help.volume+'</li>          <li title="V - '+f.lang[f.language].help.decreaseVol+'"><strong>V</strong>'+f.lang[f.language].help.decreaseVol+'</li>          <li title="B - '+f.lang[f.language].help.increaseVol+'"><strong>B</strong>'+f.lang[f.language].help.increaseVol+'</li>          <li title="A - '+f.lang[f.language].help.adVolume+'"><strong>A</strong>'+f.lang[f.language].help.adVolume+'</li>          <li title="Z - '+f.lang[f.language].help.adDecreaseVol+'"><strong>Z</strong>'+f.lang[f.language].help.adDecreaseVol+'</li>          <li title="X - '+f.lang[f.language].help.adIncreaseVol+'"><strong>X</strong>'+f.lang[f.language].help.adIncreaseVol+'</li>          <li title="F - '+f.lang[f.language].help.viewport+'"><strong>F</strong>'+f.lang[f.language].help.viewport+'</li>          <li title="H - '+f.lang[f.language].help.help+'"><strong>H</strong>'+f.lang[f.language].help.help+"</li>");f.facilitas_help.find(".facilitas_help_about ul").html("<li>Facilitas Player v"+f.version+"</li>          <li>"+f.lang[f.language].help.developed+' <a href="mailto:contato@brunoramos.eti.br" title="Bruno Ramos">Bruno Ramos</a></li>          <li><a href="'+f.aboutUrl+'" target="_blank" title="Facilitas Player">'+f.aboutUrl+"</a></li>");if(f.hasTags){f.facilitas_tags_goto.attr("title",f.lang[f.language].tags.goTo).html(f.lang[f.language].tags.goTo+":")}},prepareSubtitle:function(){var c=this,e=this.options,d=e.subtitleSrc;c.$elem.children().each(function(){var f=b(this).get(0);if(f.nodeName.toLowerCase()=="track"&&f.getAttribute("kind")=="subtitle"){d=f.getAttribute("src")}});if(d){if(d.indexOf(".srt")!=-1){c.subtitleFontUpdate();b.get(d,function(h){if(h.length>0){e.subtitle=new Array();var f=h.split("\n\n");var j=f.length;for(var g=0;g<j;g++){e.subtitle[g]=f[g].split("\n")}e.subtitleTotal=j;c.enableSubtitleBtn()}else{c.disableBtn(e.facilitas_search_btn);if(e.debug){c.trace("Invalid subtitle source. Maybe using a cross-domain source?")}}})}else{c.disableBtn(e.facilitas_search_btn);if(e.debug){c.trace('Not a valid subtitle source. File must be ".srt".')}}}else{c.disableBtn(e.facilitas_search_btn);if(e.debug){c.trace("No subtitle track found.")}}},prepareAudiodescription:function(){var g=this,h=this.options,c,f,e;if(h.audiodescription){c=h.audiodescription.split(";");h.facilitas_audiodesc=b('<audio class="facilitas_audiodesc" preload="auto"></audio>');for(var d in c){e=c[d].split(".");e=e[e.length-1];switch(e){case"ogg":f="audio/ogg";break;case"mp3":f="audio/mpeg";break}h.facilitas_audiodesc.append('<source src="'+c[d]+'" type="'+f+'"></source>')}h.video_container.append(h.facilitas_audiodesc);h.facilitas_search_btn.parent().before(+'          <li>            <a href="javascript:void();" class="facilitas_btn_audiodesc" title="'+h.lang[h.language].toolbar.audiodesc+'">              <span class="advol_status fac-i-audio-desc"></span>              <div class="facilitas_btn_container ad"></div>              <div class="facilitas_advol_container">                  <div class="facilitas_advol_wrapper">                      <div class="facilitas_control_advolume_slider"></div>                  </div>              </div>            </a>          </li>');h.facilitas_audiodesc_btn=h.video_container.find(".facilitas_btn_audiodesc");h.facilitas_advolume=b(".facilitas_btn_audiodesc",h.video_container);h.facilitas_advolume_btn=b(".facilitas_btn_container.ad",h.video_container);h.facilitas_advolume_status=b(".advol_status",h.video_container);h.facilitas_advolume_slider=b(".facilitas_control_advolume_slider",h.video_container);h.facilitas_advolume_cont=b(".facilitas_advol_container",h.video_container);h.facilitas_advolume_slider.slider({value:h.initAdVolume,orientation:"vertical",range:"min",max:1,step:0.1,animate:true,slide:function(k,j){g.toggleAdMute(j.value)}});h.facilitas_audiodesc.prop("volume",h.initAdVolume);h.facilitas_advolume.on("mouseenter",function(){g.showAdVolumeBar()}).on("mouseleave",function(){g.hideAdVolumeBar()}).on("click",function(j){g.toggleAdMute(null);j.preventDefault();return false});h.facilitas_audiodesc.bind("volumechange",function(){g.adVolumeUpdate()});g.startAudiodescListeners()}},prepareTranscripts:function(){var d=this,e=this.options,c;d.$elem.children().each(function(){var f=b(this).get(0);if(f.nodeName.toLowerCase()=="track"&&f.getAttribute("kind")=="transcript"){c=f.getAttribute("src")}});if(c){if(c.indexOf(".txt")!=-1){b.get(c,function(j){if(j.length>0){e.transcripts=new Array();var f=j.split("\n"),l=f.length,h=e.facilitas_transcript.find("ol"),k="fac-"+Date.now();e.facilitas_transcript.attr("id",k);e.transcriptTotal=l;for(var g in f){h.append("<li>"+f[g]+"</li>")}d.enableTranscriptBtn();if(typeof(WebLibras)=="function"){new WebLibras("#"+k)}}else{d.disableBtn(e.facilitas_transcript_btn);if(e.debug){d.trace("Invalid transcript source. Maybe using a cross-domain source?")}}})}else{d.disableBtn(e.facilitas_transcript_btn);if(e.debug){d.trace('Not a valid subtitle source. File must be ".srt".')}}}else{d.disableBtn(e.facilitas_transcript_btn);if(e.debug){d.trace("No transcript track found.")}}},startAudiodescListeners:function(){var c=this.$elem,d=this.options.facilitas_audiodesc,h=this,g=this.$elem[0],f=d[0],e=null;c.on("play",function(){f.play();if(e=="ad"){e=null}else{e="video"}}).on("pause",function(){f.pause();if(e=="ad"){e=null}else{e="video"}});b(window).on("fac-ad-updateTime",function(){d.prop("currentTime",c.prop("currentTime"))});d.on("play",function(){if(e=="video"){e=null}else{e="ad";g.play();h.hideLoading()}}).on("pause",function(){if(e=="video"){e=null}else{e="ad";g.pause();h.showLoading()}})},play:function(){var c=this.options.videoObject;if(c.paused){c.play()}else{c.pause()}},stop:function(){var c=this.options.videoObject;c.pause();c.currentTime=0;if(this.options.audiodescription){this.options.facilitas_audiodesc[0].currentTime=0}},toggleCCBtn:function(c){var d=this;var e=this.options;switch(c){case"CC":d.toggleClosedCaption();break;case"SE":d.toggleSubtitle();break;default:if(e.debug){d.trace("Invalid type. => "+c)}break}},toggleSubtitle:function(){var d=this.options;var c=d.facilitas_cc;if(c.hasClass("disabled")){c.removeClass("disabled");d.facilitas_subtitle.show()}else{c.addClass("disabled");d.facilitas_subtitle.hide()}},toggleMute:function(d){var c=this,e=this.options;if(d>0){e.facilitas_volume_status.removeClass("fac-i-sound-muted");(d>=0.9)?e.facilitas_volume_status.removeClass("fac-i-sound-half").addClass("fac-i-sound-full"):e.facilitas_volume_status.removeClass("fac-i-sound-full").addClass("fac-i-sound-half");c.$elem.prop("muted",false);c.$elem.prop("volume",d)}else{if(c.$elem.prop("muted")==true){e.facilitas_volume_status.removeClass("fac-i-sound-muted");(d>=0.9)?e.facilitas_volume_status.removeClass("fac-i-sound-half").addClass("fac-i-sound-full"):e.facilitas_volume_status.removeClass("fac-i-sound-full").addClass("fac-i-sound-half");c.$elem.prop("muted",false);if(e.oldVol!=null){c.$elem.prop("volume",e.oldVol);e.oldVol=null}}else{e.oldVol=e.facilitas_volume_slider.slider("value");e.facilitas_volume_status.removeClass("fac-i-sound-full fac-i-sound-half").addClass("fac-i-sound-muted");c.$elem.prop("muted",true);c.$elem.prop("volume",0)}}},toggleAdMute:function(d){var c=this,e=this.options;$ad=e.facilitas_audiodesc;if(d>0){e.facilitas_advolume_status.removeClass("fac-i-audio-desc-mute").addClass("fac-i-audio-desc");$ad.prop("muted",false).prop("volume",d)}else{if($ad.prop("muted")==true){e.facilitas_advolume_status.removeClass("fac-i-audio-desc-mute").addClass("fac-i-audio-desc");$ad.prop("muted",false);if(e.oldAdVol!=null){$ad.prop("volume",e.oldAdVol);e.oldAdVol=null}}else{e.oldAdVol=e.facilitas_advolume_slider.slider("value");e.facilitas_advolume_status.removeClass("fac-i-audio-desc").addClass("fac-i-audio-desc-mute");$ad.prop("muted",true);$ad.prop("volume",0)}}},rewind:function(){var c=this.options.videoObject;var d=c.currentTime;d=((d-10)<0)?0:d-10;this.timeUpdate(d)},forward:function(){var c=this.options.videoObject;var e=c.currentTime;var d=c.duration;e=((e+10)>d)?d:e+10;this.timeUpdate(e)},speedDown:function(){var c=this.options;if(c.supportsSpeedChange){if(c.videoSpeed!=0.0625){c.videoSpeed=c.videoSpeed/2}this.$elem.prop("playbackRate",c.videoSpeed);this.updateSpeedDisplay()}},speedUp:function(){var c=this.options;if(c.supportsSpeedChange){if(c.videoSpeed!=16){c.videoSpeed=c.videoSpeed*2}this.$elem.prop("playbackRate",c.videoSpeed);this.updateSpeedDisplay()}},updateSpeedDisplay:function(){var c=this.options;if(c.videoSpeed==1){c.facilitas_speedwarning.hide()}else{c.facilitas_speedwarning.html(c.videoSpeed+"x").show()}},updateLightPos:function(j){var g=this,k=this.options,e=(-1)*g.options.video_container.width()/2,d=(-1)*g.options.video_container.height()/2,f=b(window).width(),c=b(window).height(),h=b(window).height()/2-g.options.facilitas_toolbar.height();if(g.options.isLightOn||j){k.video_container.appendTo(k.body);k.video_container.css({position:"fixed",left:"50%",top:h,"margin-left":e,"margin-top":d});k.facilitas_light_bg.addClass("active")}else{k.facilitas_light_bg.removeClass("active")}},toggleLight:function(){var c=this;var d=this.options;if(!d.isLightOn){d.facilitas_light_bg.addClass("active");d.video_container.addClass("lightson");c.updateLightPos(true);d.facilitas_light_toggle.addClass("active");d.facilitas_light_toggle.attr("title",d.lang[d.language].lights.turnOn);d.isLightOn=true}else{d.video_container.css({position:"relative",left:0,top:0,"margin-left":0,"margin-top":0}).appendTo(d.parent);d.facilitas_light_bg.removeClass("active");d.video_container.removeClass("lightson");d.facilitas_light_toggle.removeClass("active");d.facilitas_light_toggle.attr("title",d.lang[d.language].lights.turnOff);d.isLightOn=false}},toggleHelp:function(){var c=this.options;if(c.helpIsOpen){c.facilitas_help.fadeOut(100);c.helpIsOpen=false}else{c.facilitas_help.fadeIn(100);c.helpIsOpen=true}},showVolumeBar:function(){this.options.facilitas_volume_cont.show()},hideVolumeBar:function(){this.options.facilitas_volume_cont.hide()},showAdVolumeBar:function(){this.options.facilitas_advolume_cont.show()},hideAdVolumeBar:function(){this.options.facilitas_advolume_cont.hide()},increaseVolume:function(){var d=this.options;var c=d.facilitas_volume_slider.slider("value");if(c==0){this.toggleMute();c=0.2}else{c=(c+0.2>1)?1:c+0.2}this.$elem.prop("volume",c)},decreaseVolume:function(){var d=this.options;var c=d.facilitas_volume_slider.slider("value");if(c-0.2<=0){this.toggleMute()}else{this.$elem.prop("volume",c-0.2)}},increaseAdVolume:function(){var e=this.options,d=e.facilitas_advolume_slider.slider("value"),c=e.facilitas_audiodesc;if(d==0){this.toggleAdMute();d=0.2}else{d=(d+0.2>1)?1:d+0.2}c.prop("volume",d)},decreaseAdVolume:function(){var e=this.options,d=e.facilitas_advolume_slider.slider("value"),c=e.facilitas_audiodesc;if(d-0.2<=0){this.toggleAdMute()}else{c.prop("volume",d-0.2)}},cancelFullScreen:function(){var d=this,e=d.options;if(e.isFullscreen){d.$elem.width(d.$elem.prop("width"));if(e.Prefix===""){d.cancelFullScreen()}else{var c=e.browserPrefix;document[e.browserPrefix+"CancelFullScreen"]()}e.isFullscreen=false;e.facilitas_viewport.removeClass("facilitas_btn_viewport_close").attr("title",e.lang[e.language].toolbar.viewport).html('<span class="fac-i-fullscreen-open"></span>');d.cancelFullscreenTimer();if(e.fullscreenToolbarHidden){e.facilitas_progress.fadeIn(200);e.facilitas_toolbar.fadeIn(200);e.fullscreenToolbarHidden=false}}},toggleFullScreen:function(){var c=this.options;if(c.supportsFullScreen){if(c.isFullscreen){this.cancelFullScreen()}else{this.enableFullScreen()}}else{alert("Seu navegador não suporta fullscreen!")}},hideFullscreenToolbar:function(){var c=this.options;if(c.isFullscreen&&!c.fullscreenToolbarHidden&&!c.fullscreenToolbarHover){c.facilitas_progress.fadeOut(200);c.facilitas_toolbar.fadeOut(200);c.fullscreenToolbarHidden=true}},startFullscreenTimer:function(){var c=this,d=c.options;d.fullscreenTimer=setInterval(function(){c.hideFullscreenToolbar()},d.fullscreenToolbarSpeed)},cancelFullscreenTimer:function(){clearInterval(this.options.fullscreenTimer)},enableSubtitleBtn:function(){var c=this,d=c.options;d.facilitas_cc.removeClass("disabled");d.facilitas_cc.off().on("click",function(f){c.toggleSubtitle();f.preventDefault();return false})},enableTranscriptBtn:function(){var c=this,d=c.options;d.facilitas_transcript_btn.removeClass("disabled");d.facilitas_transcript_btn.off().on("click",function(f){c.toggleTranscriptSidebar();f.preventDefault();return false})},enableFullScreen:function(){var d=this,e=d.options;if(!e.isFullscreen){d.$elem.width("100%");if(e.Prefix===""){d.requestFullScreen()}else{var c=e.browserPrefix;e.video_container[0][e.browserPrefix+"RequestFullScreen"]()}e.isFullscreen=true;e.facilitas_viewport.addClass("facilitas_btn_viewport_close").attr("title",e.lang[e.language].toolbar.viewportClose).html('<span class="fac-i-fullscreen-close"></span>');b(document).on("fullscreenchange mozfullscreenchange webkitfullscreenchange",function(){d.hideLightBtn();if(!d.fullScreenStatus()){e.isFullscreen=false;d.cancelFullscreenTimer();if(e.fullscreenToolbarHidden){e.facilitas_progress.fadeIn(200);e.facilitas_toolbar.fadeIn(200);e.fullscreenToolbarHidden=false}d.$elem.width(d.$elem.prop("width"))}d.subtitleFontUpdate()});d.startFullscreenTimer()}},showLightBtn:function(){this.options.facilitas_light_toggle.fadeIn(100)},hideLightBtn:function(){this.options.facilitas_light_toggle.fadeOut(100)},showLoading:function(){var c=this.options;if(!c.loading){c.facilitas_loading.show();c.loading=true}},hideLoading:function(){var c=this.options;if(c.loading){c.facilitas_loading.hide();c.loading=false}},closeSidebar:function(c,d){if(this.options.sidebar_captionsearch&&c=="search"){this.hideCaptionSearchSidebar(function(){if(d){d()}})}else{if(this.options.sidebar_settings&&c=="settings"){this.hideSettingsSidebar(function(){if(d){d()}})}else{if(this.options.sidebar_transcript&&c=="transcript"){this.hideTranscriptSidebar(function(){if(d){d()}})}else{if(d){d()}}}}},toggleCaptionSearchSidebar:function(c){this.cancelFullScreen();if(this.options.sidebar_captionsearch){this.hideCaptionSearchSidebar(function(){if(c){c()}})}else{this.showCaptionSearchSidebar(function(){if(c){c()}})}},showCaptionSearchSidebar:function(e){this.hideSettingsSidebar();var d=this.options;var c=this.options.facilitas_caption_search.width()*(-1)-2;d.facilitas_caption_search.animate({right:c},200,function(){d.sidebar_captionsearch=true;d.facilitas_search_input.focus();if(e){e()}})},hideCaptionSearchSidebar:function(d){var c=this.options;c.facilitas_caption_search.animate({right:0},200,function(){c.sidebar_captionsearch=false;c.facilitas_search_btn.focus();if(d){d()}})},toggleSettingsSidebar:function(c){this.cancelFullScreen();if(this.options.sidebar_settings){this.hideSettingsSidebar(function(){if(c){c()}})}else{this.showSettingsSidebar(function(){if(c){c()}})}},toggleTranscriptSidebar:function(c){this.cancelFullScreen();if(this.options.sidebar_transcript){this.hideTranscriptSidebar(function(){if(c){c()}})}else{this.showTranscriptSidebar(function(){if(c){c()}})}},showSettingsSidebar:function(e){this.hideCaptionSearchSidebar();var d=this.options,c=this.options.facilitas_settings.width()*(-1)-2;d.facilitas_settings.animate({right:c},200,function(){d.sidebar_settings=true;d.facilitas_settings.find("select").first().focus();if(e){e()}})},hideSettingsSidebar:function(d){var c=this.options;c.facilitas_settings.animate({right:0},200,function(){c.sidebar_settings=false;c.facilitas_settings_btn.focus();if(d){d()}})},showTranscriptSidebar:function(e){var d=this.options,c=this.options.facilitas_transcript.width()*(-1)-2;d.facilitas_transcript.animate({left:c},200,function(){d.sidebar_transcript=true;if(e){e()}})},hideTranscriptSidebar:function(d){var c=this.options;c.facilitas_transcript.animate({left:0},200,function(){c.sidebar_transcript=false;c.facilitas_transcript_btn.focus();if(d){d()}})},searchSubtitle:function(){var d=this;var g=this.options;var f=g.facilitas_search_input.val();var e=false;if(g.subtitle){if(f.length>0){g.facilitas_search_result.empty();for(i=0,n=g.subtitle.length;i<n;i++){if(g.subtitle[i][2].toLowerCase().indexOf(f.toLowerCase())!=-1){e=true;var c=d.getSearchResultTime(g.subtitle[i][1]);g.facilitas_search_result.append('<li>  <a href="#'+c[0]+'" title="'+c[0]+'">      <span class="facilitas_search_time">['+c[0]+" - "+c[1]+']</span>      <p class="facilitas_search_description">'+g.subtitle[i][2]+"</p>  </a></li>")}}if(!e){g.facilitas_search_result.empty().append("<li>"+g.lang[g.language].sidebarSearch.notfound+"</li>")}}else{if(d.options.debug){d.trace("Empty input, cannot search!")}}}else{if(d.options.debug){d.trace("No subtitle file loaded.")}}},disableBtn:function(d){var c=this;d.addClass("disabled");d.off().on("click",function(f){if(c.options.debug){c.trace("No file provided or your browser doesn't support this feature.")}f.preventDefault();return false})},changeColor:function(d){var c=this;var e=this.options;if(d.length>=6){if(d.length==6&&d.substr(0,1)!="#"){e.facilitas_fontcolor.val("#"+d);d="#"+d}e.facilitas_subtitle.css("color",d)}else{if(e.debug){c.trace("Invalid color")}}},timeUpdate:function(d){var c=this.options.videoObject;c.currentTime=d;b.event.trigger("fac-ad-updateTime")},goTo:function(c){var c=this.secondsTimeFormat(c);this.timeUpdate(c)},seekUpdate:function(){var c=this.options.videoObject;if(this.options.init){var e=c.currentTime;if(!this.options.seekSliding){this.options.facilitas_video_seek.slider("value",e)}var f=this.videoTimeFormat(e);var d=this.videoTimeFormat(c.duration);this.options.facilitas_video_timer.text(f+" / "+d)}},updateBufferRange:function(){var e=this.options.videoObject;var g=e.buffered;for(var d=0;d<g.length;d++){var f=g.start(d);var c=g.end(d);if(e.currentTime>=f&&e.currentTime<=c){this.options.currentBuffer=d}}},bufferUpdate:function(){var e=this.options.videoObject;if(this.options.init){var d=0;var c=e.buffered;if(c&&c.length>0&&c.end&&e.duration){d=c.end(this.options.currentBuffer)/e.duration}else{d=e.bufferedBytes/e.bytesTotal}d*=100;var f=(c.start(this.options.currentBuffer)<0)?0:(c.start(this.options.currentBuffer)/e.duration)*100;this.options.facilitas_video_buffer.slider("values",[f,d])}},volumeUpdate:function(){var c=this.options.videoObject;this.options.facilitas_volume_slider.slider("value",c.volume)},adVolumeUpdate:function(){var c=this.options.facilitas_audiodesc;this.options.facilitas_advolume_slider.slider("value",c[0].volume)},subtitleUpdate:function(){var d=this,j=this.options,e=d.$elem.prop("currentTime"),o="",c=null,m,k=j.currentSubtitleLine,f=j.newSubtitleLine,h=null,g=0,l;if(j.transcripts){c=j.facilitas_transcript.find("li")}for(i=0;i<j.subtitleTotal;i++){if(d.subtitleGetTime(j.subtitle[i][1],"min")<e&&d.subtitleGetTime(j.subtitle[i][1],"max")>e){o=j.subtitle[i][2];j.newSubtitleLine=i;h=i}if(j.currentSubtitleLine!=j.newSubtitleLine){j.facilitas_transcript.find("li.highlight").removeClass("highlight");if(typeof(c[j.newSubtitleLine])!=="undefined"){l=b(c[j.newSubtitleLine]).position().top;if(l!=g){j.facilitas_transcript.animate({scrollTop:l},200);g=l}c[j.newSubtitleLine].className="highlight"}if(typeof(j.newSubtitleLine)!=="undefined"){j.currentSubtitleLine=j.newSubtitleLine;j.facilitas_subtitle.html(o).attr("title",o)}}}if(h==null){j.facilitas_subtitle.html("").attr("title","")}},subtitleFontUpdate:function(){var d=this;var f=d.options.facilitas_subtitle.css("font-size");var c=d.options.facilitas_subtitle.css("bottom");if(d.$elem.width()>400){f=f+Math.ceil((d.$elem.width()-400)/100);c=c+Math.ceil((d.$elem.width()-400)/100)}var e=parseInt(f)+4;d.options.facilitas_subtitle.css({"font-size":f+"px","line-height":(e)+"px",bottom:c+"px"})},videoTimeFormat:function(e){var c=Math.floor(e/60)<10?"0"+Math.floor(e/60):Math.floor(e/60);var d=Math.floor(e-(c*60))<10?"0"+Math.floor(e-(c*60)):Math.floor(e-(c*60));return c+":"+d},secondsTimeFormat:function(e){var c=e.split(":");if(c.length==2){var d=parseInt(c[1])+parseInt(c[0])*60}else{if(c.length==3){var d=parseInt(c[2])+parseInt(c[1])*60+parseInt(c[0])*60*60}}return d},subtitleTimeFix:function(d){var c=d.split(",")[0].split(":");return Math.floor(c[0]*60*60)+Math.floor(c[1]*60)+Math.floor(c[2])+parseFloat("."+d.split(",")[1])},subtitleGetTime:function(c,d){return(d=="min")?this.subtitleTimeFix(c.split(" --> ")[0]):this.subtitleTimeFix(c.split(" --> ")[1])},getSearchResultTime:function(g){var f=g.split(" --> ");var e=f[0].split(",")[0];var d=f[1].split(",")[0];var c=new Array(2);c[0]=e;c[1]=d;return c},trace:function(c){try{console.log(c)}catch(d){alert(c)}return},fullScreenStatus:function(){return(document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen||false)}};b.fn.extend=function(c){if(this.length){return this.each(function(){var d=Object.create(a);a.init(c,this);b.data(this,"FacilitasPlayer",d)})}};b.plugin("facilitas",a)})(jQuery);